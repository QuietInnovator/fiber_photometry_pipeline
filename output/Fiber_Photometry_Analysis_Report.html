<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiber Photometry Analysis Report</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --background-color: #f8f9fa;
            --text-color: #2c3e50;
            --border-color: #dee2e6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 300;
        }

        .author-info {
            background: rgba(255,255,255,0.1);
            padding: 1rem;
            margin: 1rem auto;
            border-radius: 10px;
            max-width: 600px;
            backdrop-filter: blur(10px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .section {
            background: white;
            margin: 2rem 0;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            border-left: 5px solid var(--secondary-color);
        }

        .section h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }

        .section h3 {
            color: var(--secondary-color);
            margin: 1.5rem 0 1rem 0;
            font-size: 1.3rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transform: translateY(0);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card h4 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            font-weight: 300;
        }

        .stat-card p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .plot-container {
            margin: 2rem 0;
            text-align: center;
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .plot-container img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .plot-container h3 {
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .plot-description {
            margin-top: 1rem;
            font-style: italic;
            color: #666;
            text-align: left;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .data-table th,
        .data-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table th {
            background: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        .data-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .data-table tr:hover {
            background: #e3f2fd;
        }

        .highlight-box {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-left: 5px solid var(--accent-color);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 10px 10px 0;
        }

        .highlight-box h4 {
            color: var(--accent-color);
            margin-bottom: 1rem;
        }

        .footer {
            background: var(--primary-color);
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 3rem;
        }

        .tabs {
            display: flex;
            background: white;
            border-radius: 10px 10px 0 0;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            background: var(--border-color);
            cursor: pointer;
            transition: background 0.3s;
            border: none;
            font-size: 1rem;
        }

        .tab.active {
            background: var(--secondary-color);
            color: white;
        }

        .tab-content {
            display: none;
            background: white;
            padding: 2rem;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>Fiber Photometry Analysis Report</h1>
        <div class="author-info">
            <h3>Author: Chadi Abi Fadel</h3>
            <p><strong>Analysis Date:</strong> September 7, 2025</p>
            <p><strong>Input File:</strong> Fluorescence.csv</p>
            <p><strong>Recording Duration:</strong> 649.39 seconds (~10.8 minutes)</p>
        </div>
    </header>

    <div class="container">
        <!-- Executive Summary -->
        <section class="section">
            <h2>🎯 Executive Summary</h2>
            <p>This report presents the analysis of high-quality fiber photometry recordings from a single channel (CH1) with dual-wavelength excitation. The analysis reveals <strong>19 spontaneous calcium transients</strong> with characteristics consistent with neural activity patterns over approximately 10.8 minutes of recording.</p>
            
            <div class="highlight-box">
                <h4>Key Findings</h4>
                <ul>
                    <li><strong>19 calcium transients</strong> detected at 105.33 events/hour</li>
                    <li><strong>Mean amplitude:</strong> 0.023 ± 0.005 ΔF/F</li>
                    <li><strong>Exceptional signal quality</strong> with zero baseline drift</li>
                    <li><strong>No behavioral events</strong> detected in this baseline recording</li>
                </ul>
            </div>
        </section>

        <!-- Key Statistics -->
        <section class="section">
            <h2>📊 Key Statistics</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>19</h4>
                    <p>Total Transients Detected</p>
                </div>
                <div class="stat-card">
                    <h4>105.33</h4>
                    <p>Events per Hour</p>
                </div>
                <div class="stat-card">
                    <h4>0.023</h4>
                    <p>Mean Amplitude (ΔF/F)</p>
                </div>
                <div class="stat-card">
                    <h4>2.63</h4>
                    <p>Mean Duration (seconds)</p>
                </div>
                <div class="stat-card">
                    <h4>50 Hz</h4>
                    <p>Actual Sampling Rate</p>
                </div>
                <div class="stat-card">
                    <h4>99.85%</h4>
                    <p>Data Retention Rate</p>
                </div>
            </div>
        </section>

        <!-- Analysis Plots -->
        <section class="section">
            <h2>📈 Analysis Results</h2>
            
            <div class="tabs">
                <button class="tab active" onclick="showTab('raw')">Raw Signals</button>
                <button class="tab" onclick="showTab('dff')">ΔF/F & Z-scores</button>
                <button class="tab" onclick="showTab('transients')">Transients</button>
                <button class="tab" onclick="showTab('summary')">Summary</button>
            </div>

            <div id="raw" class="tab-content active">
                <div class="plot-container">
                    <h3>Raw Fluorescence Signals</h3>
                    <img src="raw_signals.png" alt="Raw Fluorescence Signals">
                    <div class="plot-description">
                        <p><strong>Description:</strong> Raw fluorescence traces showing 410nm isosbestic control (blue) and 470nm signal (red) channels. The 410nm channel serves as a control for motion artifacts and general fluorescence changes, while the 470nm channel captures calcium-dependent GCaMP fluorescence.</p>
                    </div>
                </div>
            </div>

            <div id="dff" class="tab-content">
                <div class="plot-container">
                    <h3>ΔF/F and Z-score Analysis</h3>
                    <img src="dff_and_zscores.png" alt="ΔF/F and Z-scores">
                    <div class="plot-description">
                        <p><strong>Description:</strong> Normalized ΔF/F signal (top) shows calcium transients after motion artifact correction using the control channel. Z-score transformation (bottom) standardizes the signal for statistical analysis and transient detection.</p>
                    </div>
                </div>
            </div>

            <div id="transients" class="tab-content">
                <div class="plot-container">
                    <h3>Detected Calcium Transients</h3>
                    <img src="transients.png" alt="Calcium Transients">
                    <div class="plot-description">
                        <p><strong>Description:</strong> Individual calcium transients (red markers) overlaid on the ΔF/F trace. The histogram shows the distribution of transient amplitudes, revealing a relatively uniform distribution with slight right skew. Detection used MAD thresholding at 3.5σ.</p>
                    </div>
                </div>
            </div>

            <div id="summary" class="tab-content">
                <div class="plot-container">
                    <h3>Comprehensive Analysis Summary</h3>
                    <img src="summary_report.png" alt="Summary Report">
                    <div class="plot-description">
                        <p><strong>Description:</strong> Multi-panel summary showing (1) raw signals, (2) ΔF/F trace with detected transients, (3) event-related analysis (no events found), and (4) transient properties distributions including amplitude, duration, and temporal characteristics.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Technical Specifications -->
        <section class="section">
            <h2>⚙️ Technical Specifications</h2>
            <div class="stats-grid">
                <div class="stat-card" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                    <h4>649.39 s</h4>
                    <p>Recording Duration</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%);">
                    <h4>32,471</h4>
                    <p>Total Samples</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #fdbb2d 0%, #22c1c3 100%);">
                    <h4>25.8% / 60.0%</h4>
                    <p>LED Power (410nm/470nm)</p>
                </div>
            </div>

            <h3>Recording Parameters</h3>
            <table class="data-table">
                <tr>
                    <th>Parameter</th>
                    <th>Value</th>
                    <th>Notes</th>
                </tr>
                <tr>
                    <td>Sampling Rate</td>
                    <td>50 Hz (actual) / 100 Hz (expected)</td>
                    <td>Discrepancy may limit fast kinetics detection</td>
                </tr>
                <tr>
                    <td>Channels</td>
                    <td>CH1-410, CH1-470</td>
                    <td>Dual-wavelength isosbestic control</td>
                </tr>
                <tr>
                    <td>LED Power</td>
                    <td>410nm: 25.8%, 470nm: 60.0%</td>
                    <td>Optimized for GCaMP imaging</td>
                </tr>
                <tr>
                    <td>Data Quality</td>
                    <td>Zero baseline standard deviation</td>
                    <td>Exceptionally stable recording</td>
                </tr>
            </table>
        </section>

        <!-- Transient Analysis -->
        <section class="section">
            <h2>🧠 Calcium Transient Analysis</h2>
            
            <h3>Statistical Summary</h3>
            <table class="data-table">
                <tr>
                    <th>Property</th>
                    <th>Mean ± SEM</th>
                    <th>Median</th>
                    <th>Min</th>
                    <th>Max</th>
                </tr>
                <tr>
                    <td>Amplitude (ΔF/F)</td>
                    <td>0.023 ± 0.005</td>
                    <td>0.022</td>
                    <td>0.018</td>
                    <td>0.041</td>
                </tr>
                <tr>
                    <td>Duration (s)</td>
                    <td>2.63 ± 1.81</td>
                    <td>2.23</td>
                    <td>0.78</td>
                    <td>6.25</td>
                </tr>
                <tr>
                    <td>Area Under Curve</td>
                    <td>0.066 ± 0.041</td>
                    <td>0.052</td>
                    <td>0.022</td>
                    <td>0.156</td>
                </tr>
                <tr>
                    <td>Rise Time (s)</td>
                    <td>1.24 ± 1.11</td>
                    <td>0.72</td>
                    <td>0.33</td>
                    <td>5.32</td>
                </tr>
                <tr>
                    <td>Decay Time (s)</td>
                    <td>1.39 ± 0.84</td>
                    <td>1.28</td>
                    <td>0.38</td>
                    <td>3.09</td>
                </tr>
            </table>

            <div class="highlight-box">
                <h4>Notable Transients</h4>
                <ul>
                    <li><strong>Largest Amplitude:</strong> 0.041 ΔF/F at 32.78 seconds</li>
                    <li><strong>Longest Duration:</strong> 6.25 seconds at 468.51 seconds</li>
                    <li><strong>Temporal Clustering:</strong> Some events cluster around 470-480 seconds</li>
                    <li><strong>Consistent Morphology:</strong> Fast rise, slower decay typical of calcium dynamics</li>
                </ul>
            </div>
        </section>

        <!-- Signal Processing -->
        <section class="section">
            <h2>🔬 Signal Processing Pipeline</h2>
            
            <h3>Preprocessing Steps</h3>
            <div class="stats-grid">
                <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <h4>1.0 s</h4>
                    <p>LED Artifact Trimmed</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <h4>0.5 s</h4>
                    <p>Smoothing Window</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <h4>Control-Fit</h4>
                    <p>Normalization Method</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                    <h4>3.5 MAD</h4>
                    <p>Detection Threshold</p>
                </div>
            </div>

            <h3>Quality Control Results</h3>
            <ul>
                <li>✅ <strong>Data Retention:</strong> 99.85% of samples retained after preprocessing</li>
                <li>✅ <strong>Baseline Stability:</strong> Zero standard deviation indicates excellent recording conditions</li>
                <li>✅ <strong>Motion Artifact Correction:</strong> Effective using 410nm isosbestic control</li>
                <li>✅ <strong>Signal-to-Noise Ratio:</strong> Clean transient detection with minimal false positives</li>
                <li>⚠️ <strong>Sampling Rate:</strong> 50 Hz actual vs 100 Hz expected may limit fast kinetics</li>
            </ul>
        </section>

        <!-- Recommendations -->
        <section class="section">
            <h2>💡 Recommendations & Future Directions</h2>
            
            <div class="tabs">
                <button class="tab active" onclick="showTab('future')">Future Recordings</button>
                <button class="tab" onclick="showTab('current')">Current Dataset</button>
            </div>

            <div id="future" class="tab-content active">
                <h3>For Future Recordings</h3>
                <ul>
                    <li><strong>Verify Sampling Rate:</strong> Ensure 100 Hz acquisition for better temporal resolution</li>
                    <li><strong>Include Behavioral Events:</strong> Add relevant behavioral markers for functional analysis</li>
                    <li><strong>Extended Recording:</strong> Longer sessions would provide more statistical power</li>
                    <li><strong>Multiple Channels:</strong> Consider multi-site recordings for spatial analysis</li>
                    <li><strong>Event Synchronization:</strong> Ensure proper behavioral event timing and markers</li>
                </ul>
            </div>

            <div id="current" class="tab-content">
                <h3>Additional Analysis Options</h3>
                <ul>
                    <li><strong>Correlation Analysis:</strong> Examine relationships between transient properties</li>
                    <li><strong>Spectral Analysis:</strong> Investigate frequency content of the signal</li>
                    <li><strong>Template Matching:</strong> Develop transient templates for automated analysis</li>
                    <li><strong>Inter-Event Interval Analysis:</strong> Study temporal patterns in transient occurrence</li>
                    <li><strong>Amplitude Distribution Modeling:</strong> Fit statistical models to transient properties</li>
                </ul>
            </div>
        </section>

        <!-- File Inventory -->
        <section class="section">
            <h2>📁 Generated Files</h2>
            
            <h3>Data Files</h3>
            <table class="data-table">
                <tr>
                    <th>File</th>
                    <th>Description</th>
                    <th>Format</th>
                </tr>
                <tr>
                    <td>metadata.json</td>
                    <td>Complete recording metadata and configuration</td>
                    <td>JSON</td>
                </tr>
                <tr>
                    <td>timeseries.csv</td>
                    <td>Processed time-series data with ΔF/F values</td>
                    <td>CSV</td>
                </tr>
                <tr>
                    <td>transients.csv</td>
                    <td>Detected transients with quantified properties</td>
                    <td>CSV</td>
                </tr>
                <tr>
                    <td>events.csv</td>
                    <td>Event marker timestamps (224 total markers)</td>
                    <td>CSV</td>
                </tr>
                <tr>
                    <td>processing_log.json</td>
                    <td>Analysis pipeline execution log</td>
                    <td>JSON</td>
                </tr>
            </table>

            <h3>Visualization Files</h3>
            <ul>
                <li><strong>raw_signals.png/.svg</strong> - Raw fluorescence traces</li>
                <li><strong>dff_and_zscores.png/.svg</strong> - Normalized ΔF/F and z-score traces</li>
                <li><strong>transients.png/.svg</strong> - Overlay of detected transients</li>
                <li><strong>psth_comparison.png/.svg</strong> - PSTH comparison (no events)</li>
                <li><strong>summary_report.png/.svg</strong> - Multi-panel summary figure</li>
            </ul>
        </section>
    </div>

    <footer class="footer">
        <h3>Analysis by Chadi Abi Fadel</h3>
        <p>Generated with Fiber Photometry Analysis Pipeline • September 7, 2025</p>
        <p><em>This report represents a comprehensive analysis of spontaneous calcium dynamics in neural tissue using fiber photometry.</em></p>
    </footer>

    <script>
        function showTab(tabName) {
            // Hide all tab contents
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Add smooth scrolling for navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Add animation on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        // Observe all sections
        document.querySelectorAll('.section').forEach(section => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(20px)';
            section.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            observer.observe(section);
        });
    </script>
</body>
</html>